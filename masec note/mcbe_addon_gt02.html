<!DOCTYPE html>
<html lang="ja">
<head>
  <meta property="og:site_name" content="Masec's Note" />
  <meta property="og:title" content="【Minecraft BE(統合版)】GameTest解説#2" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://rinca-h.github.io/masec_note/masec%20note/img/masec_note_thumb.png" />
  <meta property="og:description" content="簡単にGameTestの解説をします！" />
  <meta property="og:locale" content="ja_JP" />
  <meta name="twitter:card" content="summary" />
  <meta name="keyword" content="minecraft, マイクラ, マインクラフト, アドオン, GameTest, 作り方">
  <meta name="description" content="簡単にGameTestの解説をします！">
  <title>【Minecraft BE(統合版)】GameTest解説#2 - Masec's Note</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width">
  <link rel="stylesheet" href="highlight-js/masec-light.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- <pre><code class="json">//コード  #f4f3ec </code></pre> -->
  <link rel="stylesheet" type="text/css" href="basic.css">
  <link rel="stylesheet" type="text/css" href="masec_note.css">
  <link rel="stylesheet" type="text/css" href="masec_note_mokuzi.css">
  <!--<style type="text/css"></style>-->
</head>
<body>
  <div style="padding: 0.5em;"><img id="logo" src="img/masec_note_black.png"></div>
  <div style="margin: 8px;"><span class="desc">uploaded:2021/12/10</span></div>
  <div id="whole">
    <div id="main">
      <h1 id="top">MinecraftBE - GameTest解説#2</h1>
      <div class="announce">目次は右上の「≡」から！</div>
      <p>
        　<a href="mcbe_addon_gt01.html">前回</a>の続きです！<br>
        ↓前回書いたスクリプト
      </p>
      <div class="pDat">Dat</div><div class="dir">scripts/Main.js</div>
      <pre><code class="js">import { world } from "mojang-minecraft";

let time = 0;

world.events.tick.subscribe(eventData => {

  if(time &lt; 200) {
    time = time + 1;
  }

  if(time == 120) {
    world.getDimension("overworld").runCommand("say Hello, world!");
  }

});</code></pre>
      <div id="sec01" class="headline" style="border-left: solid 10px #de8ae6;">リファレンスとの対応</div>
      <p>
        　GameTestも自由度が高いので、できればリファレンスから情報を得て自分のやりたいことをやりたいと思います。<br>
        　そのために、前回作ったスクリプトをもとにリファレンスの見かたについて解説します。
      </p>
      <h3 id="sec01sec01">リファレンスのリンク</h3>
      <p>
        ・<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/">GameTest Reference Documentation | Microsoft Docs</a><br>
        ・<a href="https://docs-microsoft-com.translate.goog/en-us/minecraft/creator/scriptapi/?_x_tr_sl=en&_x_tr_tl=ja&_x_tr_hl=ja&_x_tr_pto=wapp">↑のGoogle翻訳ぶち込みバージョン</a>
      </p>
      <p>
        　どうしても<ruby><rb>歪</rb><rp>(</rp><rt>いびつ</rt><rp>)</rp></ruby>になってしまうので、できるだけ英語で読んでほしいところですが......
      </p>
      <h3 id="sec01sec02">最初のページ</h3>
      <p>
        　左上から「GameTest(本来)の入門」「GameTestに使うmojang-gametestモジュールについて」
        「スクリプト全体で使えるmojang-minecraftモジュールについて」「UI表示に使うmojang-minecraft-uiモジュールについて」の内容になっています。<br>
        　「GameTest入門」は、アドオンをテストする"本来のGameTest"について書かれているだけなので、今回解説するような別にテストするわけじゃないスクリプトを学びたい場合は無視です。<br>
        　その他はモジュールについての説明です。それぞれ「OVERVIEW(概要)」のリンクから全ての内容が見れます。
        「REFERENCE(リファレンス)」は、OVERVIEWの中でもよく見られるであろう項目をピックアップしてるだけなので、GameTestで何ができるか<ruby><rb>漁</rb><rp>(</rp><rt>あさ</rt><rp>)</rp></ruby>るだけなら見る必要はないです。
      </p>
      <img src="img/mcbe-addon-gt01-02.png">
      <p>
        　今回見るのは一番右にあるmojang-minecraftモジュールの項目です。以前書いたコードのimport文を覚えていますか？　つまりはそういうことです^^
      </p>
      <pre><code class="js">import { world } from "mojang-minecraft";</code></pre>
      <h3 id="sec01sec03">検知できるイベント</h3>
      <p>
        　上記のimport文は「mojang-mincraft」モジュールから「world」クラスをインポートしてこいという文なので、
        mojang-minecraftのOVERVIEWにあるリンクからWorldクラスを探します。
      </p>
      <img src="img/mcbe-addon-gt01-03.png">
      <p>
        　<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/world">Worldクラスのページ</a>を開くとすぐに「Properties」があって、その下に「events」があると思います。
        このeventsプロパティが検知できるイベントをすべて持っています。<br>
        　他には返す値について書いてあります。
      </p>
      <div class="demoCode">read-only events: Events;</div>
      <p>
        　「read-only」は読み取り専用ということを表し、world.eventsは「Events」型を返すということです。<br>
        　リファレンスを読みながらコードを途中まで書いたとすると、こんな感じです。
      </p>
      <pre><code class="js">import { world } from "mojang-minecraft";
      
world.event; // → Events型</code></pre>
      <p>
        　次にEventsクラスはどんな値を持っているのでしょう？　下のTypeから<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/events">Eventsのページ</a>に飛べます。
      </p>
      <img src="img/mcbe-addon-gt01-04.png">
      <p>　リンク先のPropertiesの章を見ると下にたくさんプロパティが書いてあります。これらが検知できるイベント全てです。</p>
      <ul>
        <li>beforeChat(チャット)</li>
        <li>beforeDataDrivenEntityTriggerEvent</li>
        <li>beforeExplosion(爆発)</li>
        <li>beforeItemDefinitionEvent</li>
        <li>beforeItemUse(右クリック)</li>
        <li>beforeItemUseOn(ブロックに対して右クリック)</li>
        <li>bforePistonActive(ピストンの動作)</li>
        <li>blockBreak(ブロックの破壊)</li>
        <li>blockExplode(ブロック由来の爆発)</li>
        <li>blockPlace(ブロックが置かれる)</li>
        <li>chat(チャット)</li>
        <li>dataDrivenEntityTriggerEvent</li>
        <li>effectAdd(ポーションエフェクトがつく)</li>
        <li>entityCreate(エンティティのスポーン)</li>
        <li>explosion(爆発)</li>
        <li>itemDefinitionEvent</li>
        <li>itemUse(右クリック)</li>
        <li>itemUseOn(ブロックに対して右クリック)</li>
        <li>pistonActive(ピストンの動作)</li>
        <li>playerJoin(プレイヤーの参加)</li>
        <li>playerLeave(プレイヤーの退出)</li>
        <li>tick(毎tick)</li>
        <li>weatherChange(天気の変化)</li>
      </ul>
      <p>　今回はtickを使いました。途中のコードはこんな感じです。</p>
      <pre><code class="js">import { world } from "mojang-minecraft";
      
world.event.tick; // → TickEventSignal型</code></pre>
      <h3 id="sec01sec04">お決まりの形</h3>
      <p>
        　同様に、<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/tickeventsignal">TickEventSignalクラス</a>はどんな値を持っているか調べます。<br>
        　このクラスは二つのメソッドのみをもっているようです。イベントを観測するためにはsubscribeメソッドを使います。
      </p>
      <div class="demoCode">subscribe(callback: (arg: TickEvent) => void): (arg: TickEvent) => void</div>
      <p>
        　このように型に関することが複雑に書いてありますが、コードにしてみればわかります。
      </p>
      <pre><code class="js">import { world } from "mojang-minecraft";
      
world.event.tick.subscribe( eventData => { // → eventDataはTickEvent型
  // 処理
});</code></pre>
      <p>
        　subscribeメソッドに、eventDataを引数とする関数を渡すと、ある関数が返ってくるというふうになっているのですが、
        これが関数で──eventDataに入るのはどこから来るんだ？というようにたどってるとわけがわからなくなってくると思うので、
        JavaScriptに慣れてない場合はこれで一つのカタマリだと捉えるのがいいです。
      </p>
      <pre><code class="js">world.event.〇〇.subscribe( eventData => {
  // 処理
});</code></pre>
      <p>
        　ちなみに「eventData」は関数の引数を表すダミー変数(↓で言う「x」)なので名前は自由です。
      </p>
      <pre><code class="js">function myFunc(x) { // ここのxはオリジナルだよね
  // 処理
}</code></pre>
      <p>　ひとつのスクリプトで色んなイベントを検知する場合はこの"お決まりの形"をその分書きます。</p>
      <pre><code class="js">import { world } from "mojang-minecraft";
      
world.event.beforeExplosion.subscribe( eventData => {
  // 処理
});

world.event.blockExplode.subscribe( eventData => {
  // 処理
});

world.event.explosion.subscribe( eventData => {
  // 処理
});</code></pre>
      <h3 id="sec01sec05">具体的な処理</h3>
      <p>
        　次は「お決まりの形」の中に書く処理についてです。前回のコード通りにコマンド実行で解説します。<br>
        　コマンドはディメンションかプレイヤーのいずれかから実行できます。今回はディメンションから実行しようと思います。
      </p>
      <pre><code class="js">world.getDimension("overworld").runCommand("say Hello, world!");</code></pre>
      <p>
        　<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/world">Worldクラスのページ</a>を見ると、Methodsの章にgetDimensionメソッドがあります。
        このメソッドの引数にディメンション名を渡すとディメンションが取得できるということですね。<br>
        　そしてこのメソッドはDimension型を返すようです。途中まで書いたコードは：
      </p>
      <pre><code class="js">world.getDimension("overworld"); // → Dimnsion型</code></pre>
      <p>
        　そこから<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/dimension">Dimensionクラスのページ</a>へ移動すると、runCommandメソッドをもつことが分かりました。<br>
        　runCommandメソッドはスラッシュ無しのコマンド文字列を引数にとり、コマンドを実行したら何の値も返しません。
        これで以上ということです。
      </p>
      <div id="sec02" class="headline" style="border-left: solid 10px #de8ae6;">お<ruby><rb>復習</rb><rp>(</rp><rt>さら</rt><rp>)</rp></ruby>い</div>
      <h3 id="sec02sec01">(1) 必要なクラスをインポート</h3>
      <pre><code class="js">import { world } from "mojang-minecraft";</code></pre>
      <p>　イベントを観測するのに必要なので、worldクラスをインポートします。</p>
      <h3 id="sec02sec02">(2) お決まりの形</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

world.events.〇〇.subscribe( eventData => {

});</code></pre>
      <p>　イベントを観測するためのお決まりの形です。</p>
      <h3 id="sec02sec03">(3) 毎tick実行</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

world.events.tick.subscribe( eventData => {

});</code></pre>
      <p>
        　今回は毎tick処理を実行したいので、〇〇はtickにします。<br>
        　他のイベントは<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/events">Eventsクラスのページ</a>から確認できましたね。
      </p>
      <h3 id="sec02sec04">(4) ディメンションを取得</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

world.events.tick.subscribe( eventData => {

  world.getDimension("overworld")

});</code></pre>
      <p>
        　今回はディメンションからコマンドを動かすので、ディメンションを取得します。<br>
        　ディメンションはWorldクラスから取得できます。取得するためのメソッドは<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/world">Worldクラスのページ</a>から確認できましたね。
      </p>
      <h3 id="sec02sec05">(5) コマンドを実行</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

world.events.tick.subscribe( eventData => {

  world.getDimension("overworld").runCommand("say Hello, world!");

});</code></pre>
      <p>
        　getDimensionメソッドはDimension型を返すので、そこからコマンドを実行できます。<br>
        　コマンドを動かすメソッドは<a href="https://docs.microsoft.com/en-us/minecraft/creator/scriptapi/mojang-minecraft/dimension">Dimensionクラスのページ</a>から確認できます。
      </p>
      <h3 id="sec02sec06">(6) 時間を数えるための変数を定義</h3>
      <p>　このままだと、毎tick「Hello, world!」と言うようになってしまいます。まずは</p>
      <pre><code class="js">import { world } from "mojag-minecraft";

let time = 0;

world.events.tick.subscribe( eventData => {

  world.getDimension("overworld").runCommand("say Hello, world!");

});</code></pre>
      <p>
        　適当な変数を定義して、初期値は0とします。
      </p>
      <h3 id="sec02sec07">(7) カウントアップ</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

let time = 0;

world.events.tick.subscribe( eventData => {

  time = time + 1;

  world.getDimension("overworld").runCommand("say Hello, world!");

});</code></pre>
      <p>　毎tickカウントアップするためにお決まりの形の中に書きます。</p>
      <h3 id="sec02sec08">(8) 条件分岐</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

let time = 0;

world.events.tick.subscribe( eventData => {

  time = time + 1;

  if(time == 120) {
    world.getDimension("overworld").runCommand("say Hello, world!");
  }

});</code></pre>
      <p>　毎tickカウントアップして、120になった時だけコマンドが実行されるように、コマンド実行部分をif文の中に入れます。</p>
      <h3 id="sec02sec09">(9) ストッパー</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

let time = 0;

world.events.tick.subscribe( eventData => {

  if(time < 200) {
    time = time + 1;
  }

  if(time == 120) {
    world.getDimension("overworld").runCommand("say Hello, world!");
  }

});</code></pre>
      <p>　コマンドを実行した後でも無限に増えていくのが嫌なので、ある程度増えたらカウントアップをやめるようにします。</p>
      <h3 id="sec02sec10">(10) おまけ</h3>
      <pre><code class="js">import { world } from "mojag-minecraft";

let time = 0;

world.events.tick.subscribe( eventData => {

  time += (time < 200)? 1 : 0;

  if(time == 120) world.getDimension("overworld").runCommand("say Hello, world!");

});</code></pre>
      <p>
        　こうして短く書くこともできますね。<br>
        　次回はまた新しいコードを書いていこうと思います。
      </p>
      <!--
      <div style="height: 200px; display: flex; justify-content: flex-end; align-items: center;">
        <a href="mcbe_addon_gt03.html">GameTest解説#3</a>　→
      </div>
      -->
    </div>
    <div id="sidebar">
      <iframe src="side_bar.html"></iframe>
    </div>
  </div>
  <div align="right" style="margin: 8px;"><span style="font-size: 70%;">constructed by: Rinca Hayamine</span></div>
  <header>
    <div class="always-show">
      <a href="masec_note_home.html"><img id="logo" src="img/masec_note_black.png"></a>
      <div class="menu-button no-select"><label for="check"><div style="display: table-cell; vertical-align: middle;">≡</div></label></div>
    </div>
    <input type="checkbox" name="check" id="check" style="display: none;">
    <div id="move-box">
      <div class="menu-close no-select"><label for="check">×</label></div>
      <div class="content">
        <div style="display: flex;">
          <div style="display: inline-block; width: 50%;"><h2>もくじ</h2></div>
          <div style="display: inline-block; width: 50%; text-align: right; transform: translate(0em, 3em);"><a href="#top">ページのトップへ</a></div>
        </div>
        <hr style="background-color: #64ec86; border: 1px solid #64ec86;">
        <h4><a href="#sec01">リファレンスとの対応</a></h4>
        <p>
          ・<a href="#sec01sec01">リファレンスのリンク</a><br>
          ・<a href="#sec01sec02">最初のページ</a><br>
          ・<a href="#sec01sec03">検知できるイベント</a><br>
          ・<a href="#sec01sec04">お決まりの形</a><br>
          ・<a href="#sec01sec05">具体的な処理</a>
        </p>
        <hr style="background-color: #64ec86; border: 1px solid #64ec86;">
        <h4><a href="#sec02">お復習い</a></h4>
        <p>
          ・<a href="#sec02sec01">(1) 必要なクラスをインポート</a><br>
          ・<a href="#sec02sec02">(2) お決まりの形</a><br>
          ・<a href="#sec02sec03">(3) 毎tick実行</a><br>
          ・<a href="#sec02sec04">(4) ディメンションを取得</a><br>
          ・<a href="#sec02sec05">(5) コマンドを実行</a><br>
          ・<a href="#sec02sec06">(6) 時間を数えるための変数を定義</a><br>
          ・<a href="#sec02sec07">(7) カウントアップ</a><br>
          ・<a href="#sec02sec08">(8) 条件分岐</a><br>
          ・<a href="#sec02sec09">(9) ストッパー</a><br>
          ・<a href="#sec02sec10">(10) おまけ</a>
        </p>
      </div>
    </div>
  </header>
  <script src="responsive.js"></script>
</body>
</html>
